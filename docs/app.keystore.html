<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Python: module app.keystore</title>
</head><body>

<table class="heading">
<tr class="heading-text decor">
<td class="title">&nbsp;<br><strong class="title"><a href="app.html" class="white">app</a>.keystore</strong></td>
<td class="extra"><a href=".">index</a><br><a href="file:c%3A%5Cusers%5Cjonat%5Conedrive%5Cescritorio%5Cuni%5C9no%20semestre%5Ccriptografia%5Cproyecto%20final%20criptografia%5Capp%5Ckeystore.py">c:\users\jonat\onedrive\escritorio\uni\9no semestre\criptografia\proyecto final criptografia\app\keystore.py</a></td></tr></table>
    <p></p>
<p>
<table class="section">
<tr class="decor pkg-content-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Modules</strong></td></tr>
    
<tr><td class="decor pkg-content-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><table><tr><td class="multicolumn"><a href="base64.html">base64</a><br>
</td><td class="multicolumn"><a href="hashlib.html">hashlib</a><br>
</td><td class="multicolumn"><a href="json.html">json</a><br>
</td><td class="multicolumn"><a href="os.html">os</a><br>
</td></tr></table></td></tr></table><p>
<table class="section">
<tr class="decor index-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Classes</strong></td></tr>
    
<tr><td class="decor index-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><dl>
<dt class="heading-text"><a href="builtins.html#object">builtins.object</a>
</dt><dd>
<dl>
<dt class="heading-text">cryptography.hazmat.bindings._rust.openssl.aead.AESGCM
</dt></dl>
</dd>
</dl>
 <p>
<table class="section">
<tr class="decor title-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><a name="AESGCM">class <strong>AESGCM</strong></a>(<a href="builtins.html#object">builtins.object</a>)</td></tr>
    
<tr><td class="decor title-decor" rowspan=2><span class="code">&nbsp;&nbsp;&nbsp;</span></td>
<td class="decor title-decor" colspan=2><span class="code"><a href="#AESGCM">AESGCM</a>(key)<br>
&nbsp;<br>
<br>&nbsp;</span></td></tr>
<tr><td>&nbsp;</td>
<td class="singlecolumn">Methods defined here:<br>
<dl><dt><a name="AESGCM-decrypt"><strong>decrypt</strong></a>(self, /, nonce, data, associated_data)</dt></dl>

<dl><dt><a name="AESGCM-encrypt"><strong>encrypt</strong></a>(self, /, nonce, data, associated_data)</dt></dl>

<hr>
Static methods defined here:<br>
<dl><dt><a name="AESGCM-__new__"><strong>__new__</strong></a>(*args, **kwargs)</dt><dd><span class="code">Create&nbsp;and&nbsp;return&nbsp;a&nbsp;new&nbsp;<a href="builtins.html#object">object</a>.&nbsp;&nbsp;See&nbsp;help(type)&nbsp;for&nbsp;accurate&nbsp;signature.</span></dd></dl>

<dl><dt><a name="AESGCM-generate_key"><strong>generate_key</strong></a>(bit_length)</dt></dl>

</td></tr></table></td></tr></table><p>
<table class="section">
<tr class="decor functions-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Functions</strong></td></tr>
    
<tr><td class="decor functions-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><dl><dt><a name="-aesgcm_decrypt"><strong>aesgcm_decrypt</strong></a>(key: bytes, nonce: bytes, ciphertext: bytes, tag: bytes, *, aad: Optional[bytes] = None) -&gt; bytes</dt><dd><span class="code">Operacion&nbsp;inversa&nbsp;de&nbsp;aesgcm_encrypt.<br>
&nbsp;<br>
Args:&nbsp;key&nbsp;(bytes):&nbsp;Clave&nbsp;simétrica&nbsp;de&nbsp;32&nbsp;bytes&nbsp;(AES-256).<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nonce&nbsp;(bytes):&nbsp;Nonce&nbsp;usado&nbsp;en&nbsp;el&nbsp;cifrado&nbsp;(12&nbsp;bytes).<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ciphertext&nbsp;(bytes):&nbsp;Datos&nbsp;cifrados.&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tag&nbsp;(bytes):&nbsp;Tag&nbsp;de&nbsp;autenticación&nbsp;(16&nbsp;bytes).<br>
&nbsp;<br>
Returns:&nbsp;bytes:&nbsp;Datos&nbsp;en&nbsp;claro&nbsp;descifrados.<br>
&nbsp;<br>
Raises:&nbsp;ValueError:&nbsp;Si&nbsp;la&nbsp;longitud&nbsp;de&nbsp;la&nbsp;clave&nbsp;no&nbsp;es&nbsp;de&nbsp;32&nbsp;bytes.</span></dd></dl>
 <dl><dt><a name="-aesgcm_encrypt"><strong>aesgcm_encrypt</strong></a>(key: bytes, plaintext: bytes, *, aad: Optional[bytes] = None) -&gt; Tuple[bytes, bytes, bytes]</dt><dd><span class="code">Cifra&nbsp;datos&nbsp;con&nbsp;AES-256-GCM&nbsp;y&nbsp;separa&nbsp;nonce,&nbsp;ciphertext&nbsp;y&nbsp;tag.<br>
Args:<br>
:param&nbsp;key:&nbsp;Clave&nbsp;simétrica&nbsp;de&nbsp;32&nbsp;bytes&nbsp;(AES-256).<br>
:param&nbsp;plaintext:&nbsp;Datos&nbsp;en&nbsp;claro&nbsp;a&nbsp;cifrar.<br>
:param&nbsp;aad:&nbsp;Datos&nbsp;adicionales&nbsp;autenticados&nbsp;(no&nbsp;cifrados),&nbsp;o&nbsp;None.<br>
&nbsp;<br>
:return:&nbsp;Tupla&nbsp;(nonce,&nbsp;ciphertext,&nbsp;tag).<br>
&nbsp;<br>
:raises&nbsp;ValueError:&nbsp;Si&nbsp;la&nbsp;longitud&nbsp;de&nbsp;la&nbsp;clave&nbsp;no&nbsp;es&nbsp;de&nbsp;32&nbsp;bytes.</span></dd></dl>
 <dl><dt><a name="-b64d"><strong>b64d</strong></a>(s: str) -&gt; bytes</dt><dd><span class="code">Decodifica&nbsp;Base64&nbsp;(string&nbsp;-&gt;&nbsp;bytes).<br>
&nbsp;<br>
Args:&nbsp;s&nbsp;(str):&nbsp;Cadena&nbsp;en&nbsp;Base64.<br>
&nbsp;<br>
Returns:&nbsp;bytes:&nbsp;Datos&nbsp;binarios&nbsp;decodificados.</span></dd></dl>
 <dl><dt><a name="-b64e"><strong>b64e</strong></a>(b: bytes) -&gt; str</dt><dd><span class="code">Codifica&nbsp;datos&nbsp;binarios&nbsp;en&nbsp;Base64&nbsp;y&nbsp;devuelve&nbsp;una&nbsp;cadena&nbsp;ASCII.<br>
&nbsp;<br>
Args:<br>
:param&nbsp;b:&nbsp;Datos&nbsp;binarios&nbsp;a&nbsp;codificar.<br>
&nbsp;<br>
:returns:&nbsp;Cadena&nbsp;Base64&nbsp;en&nbsp;ASCII.</span></dd></dl>
 <dl><dt><a name="-create"><strong>create</strong></a>(passphrase: str, path: pathlib.Path = WindowsPath('app/keystore.json')) -&gt; dict</dt><dd><span class="code">Genera&nbsp;un&nbsp;par&nbsp;Ed25519,&nbsp;cifra&nbsp;la&nbsp;clave&nbsp;privada&nbsp;con&nbsp;AES-256-GCM&nbsp;bajo<br>
una&nbsp;llave&nbsp;derivada&nbsp;con&nbsp;Argon2id&nbsp;y&nbsp;genera&nbsp;un&nbsp;archivo&nbsp;llamado&nbsp;keystore.json&nbsp;<br>
para&nbsp;almacenar&nbsp;las&nbsp;claves&nbsp;e&nbsp;información.<br>
&nbsp;<br>
Args:<br>
:param&nbsp;passphrase:&nbsp;Passphrase&nbsp;usada&nbsp;para&nbsp;derivar&nbsp;la&nbsp;llave&nbsp;simétrica.<br>
:param&nbsp;path:&nbsp;Ruta&nbsp;donde&nbsp;se&nbsp;guardará&nbsp;el&nbsp;archivo&nbsp;json.<br>
&nbsp;<br>
:return:&nbsp;Documento&nbsp;JSON&nbsp;(dict)&nbsp;que&nbsp;se&nbsp;guardó&nbsp;en&nbsp;disco.<br>
:raises:&nbsp;OSError:&nbsp;si&nbsp;ocurre&nbsp;un&nbsp;error&nbsp;al&nbsp;escribir&nbsp;el&nbsp;archivo&nbsp;en&nbsp;disco.</span></dd></dl>
 <dl><dt><a name="-kdf_argon2id"><strong>kdf_argon2id</strong></a>(passphrase: str, salt: bytes, *, t_cost: int = 3, m_cost: int = 65536, parallelism: int = 1, key_len: int = 32) -&gt; bytes</dt><dd><span class="code">Deriva&nbsp;una&nbsp;clave&nbsp;simétrica&nbsp;a&nbsp;partir&nbsp;de&nbsp;una&nbsp;passphrase&nbsp;usando&nbsp;Argon2id.<br>
&nbsp;<br>
La&nbsp;función&nbsp;aplica&nbsp;Argon2id&nbsp;sobre&nbsp;la&nbsp;passphrase&nbsp;y&nbsp;una&nbsp;sal&nbsp;aleatoria<br>
para&nbsp;obtener&nbsp;una&nbsp;clave&nbsp;de&nbsp;longitud&nbsp;fija-<br>
&nbsp;<br>
Args:<br>
:param&nbsp;passphrase:&nbsp;Passphrase&nbsp;en&nbsp;texto&nbsp;claro&nbsp;introducida&nbsp;por&nbsp;el&nbsp;usuario.<br>
:param&nbsp;salt:&nbsp;Sal&nbsp;aleatoria&nbsp;usada&nbsp;en&nbsp;el&nbsp;KDF&nbsp;(mínimo&nbsp;16&nbsp;bytes).<br>
:param&nbsp;t_cost:&nbsp;Número&nbsp;de&nbsp;iteraciones&nbsp;de&nbsp;Argon2id&nbsp;(parámetro&nbsp;de&nbsp;tiempo).<br>
:param&nbsp;m_cost:&nbsp;Memoria&nbsp;en&nbsp;KiB&nbsp;utilizada&nbsp;por&nbsp;Argon2id.<br>
:param&nbsp;parallelism:&nbsp;Grado&nbsp;de&nbsp;paralelismo&nbsp;(número&nbsp;de&nbsp;lanes).<br>
:param&nbsp;key_len:&nbsp;Longitud&nbsp;de&nbsp;la&nbsp;clave&nbsp;derivada&nbsp;en&nbsp;bytes.<br>
&nbsp;<br>
:return:&nbsp;Clave&nbsp;derivada&nbsp;como&nbsp;bytes.<br>
&nbsp;<br>
:raises&nbsp;ValueError:&nbsp;Si&nbsp;la&nbsp;sal&nbsp;es&nbsp;demasiado&nbsp;corta&nbsp;o&nbsp;de&nbsp;tipo&nbsp;inválido.</span></dd></dl>
 <dl><dt><a name="-kdf_argon2id_from_params"><strong>kdf_argon2id_from_params</strong></a>(passphrase: str, kdf_params: dict) -&gt; bytes</dt><dd><span class="code">Re-deriva&nbsp;la&nbsp;clave&nbsp;simétrica&nbsp;a&nbsp;partir&nbsp;de&nbsp;los&nbsp;parámetros&nbsp;guardados&nbsp;en&nbsp;el&nbsp;keystore.<br>
&nbsp;<br>
Args:&nbsp;passphrase&nbsp;(str):&nbsp;Passphrase&nbsp;introducida&nbsp;por&nbsp;el&nbsp;usuario.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kdf_params&nbsp;(dict):&nbsp;Parámetros&nbsp;del&nbsp;KDF&nbsp;extraídos&nbsp;del&nbsp;keystore.<br>
&nbsp;<br>
Returns:&nbsp;bytes:&nbsp;Clave&nbsp;simétrica&nbsp;derivada.<br>
&nbsp;<br>
Raises:&nbsp;ValueError:&nbsp;Si&nbsp;los&nbsp;parámetros&nbsp;del&nbsp;KDF&nbsp;son&nbsp;inválidos.</span></dd></dl>
 <dl><dt><a name="-load"><strong>load</strong></a>(passphrase: str, path: pathlib.Path = WindowsPath('app/keystore.json')) -&gt; dict</dt><dd><span class="code">Carga&nbsp;y&nbsp;descifra&nbsp;el&nbsp;keystore:<br>
-&nbsp;Verifica&nbsp;checksum<br>
-&nbsp;Deriva&nbsp;la&nbsp;clave&nbsp;simétrica&nbsp;con&nbsp;Argon2id<br>
-&nbsp;Descifra&nbsp;la&nbsp;private&nbsp;key&nbsp;Ed25519<br>
&nbsp;<br>
Devuelve:<br>
{<br>
&nbsp;&nbsp;"sk":&nbsp;SigningKey,<br>
&nbsp;&nbsp;"vk":&nbsp;VerifyKey,<br>
&nbsp;&nbsp;"pubkey_bytes":&nbsp;bytes,<br>
&nbsp;&nbsp;"doc":&nbsp;dict&nbsp;del&nbsp;keystore<br>
}<br>
Args:&nbsp;passphrase&nbsp;(str):&nbsp;Passphrase&nbsp;para&nbsp;derivar&nbsp;la&nbsp;clave&nbsp;simétrica.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;(Path):&nbsp;Ruta&nbsp;del&nbsp;archivo&nbsp;keystore.json.<br>
&nbsp;<br>
Returns:&nbsp;dict:&nbsp;Diccionario&nbsp;con&nbsp;la&nbsp;clave&nbsp;privada,&nbsp;clave&nbsp;pública&nbsp;y&nbsp;el&nbsp;documento&nbsp;del&nbsp;keystore.<br>
&nbsp;<br>
Raises:&nbsp;FileNotFoundError:&nbsp;Si&nbsp;el&nbsp;archivo&nbsp;keystore&nbsp;no&nbsp;existe.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json.JSONDecodeError:&nbsp;Si&nbsp;el&nbsp;archivo&nbsp;no&nbsp;es&nbsp;un&nbsp;JSON&nbsp;válido.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;valueError:&nbsp;Si&nbsp;el&nbsp;checksum&nbsp;no&nbsp;coincide&nbsp;o&nbsp;si&nbsp;la&nbsp;KDF&nbsp;no&nbsp;es&nbsp;soportada.</span></dd></dl>
</td></tr></table><p>
<table class="section">
<tr class="decor data-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Data</strong></td></tr>
    
<tr><td class="decor data-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><strong>DEFAULT_KEYSTORE_PATH</strong> = WindowsPath('app/keystore.json')<br>
<strong>Optional</strong> = typing.Optional<br>
<strong>Tuple</strong> = typing.Tuple</td></tr></table>
</body></html>